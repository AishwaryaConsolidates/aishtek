<!DOCTYPE html>
<html lang="en-US">
<head>
	<title>Aishtrack Login</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600">
    <link rel="stylesheet" href="css/fontawesome.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/tooplate.css">
	<link rel="stylesheet" href="css/styleSheetStart.css">
	<script src="js/jquery-3.3.1.min.js"></script>
	<script src="js/amazon-cognito-auth.min.js"></script>
	<script src="js/config.js"></script>
</head>

<body>
    <div class="" id="home">
        <div class="container">
            <div class="row">
                <div class="col-12">
                <nav class="navbar navbar-expand-xl navbar-light bg-light">
	<a class="navbar-brand" href="#"> <i
		class="fas fa-3x fa-tachometer-alt tm-site-icon"></i>
		<h1 class="tm-site-title mb-0">Aishtrack</h1>
	</a>
	<button class="navbar-toggler ml-auto mr-0" type="button"
		data-toggle="collapse" data-target="#navbarSupportedContent"
		aria-controls="navbarSupportedContent" aria-expanded="false"
		aria-label="Toggle navigation">
		<span class="navbar-toggler-icon"></span>
	</button>
</nav>
                </div>
            </div>
            <!-- row -->
            <div class="row tm-content-row tm-mt-big">
              <div class="col-xl-12 col-lg-10 col-md-12 col-sm-12">
                <div class="bg-white tm-block">
                    <div class="row">
                        <div class="col-12">
                        <div id="notification"></div>


                            <h2 class="tm-block-title d-inline-block">Welcome to Aishtrack Login Page</h2>
                        </div>

  <div>
      <p id="statusNotAuth" title="Status">
          Sign-In to Continue
      </p>
      <p id="statusAuth" title="Status">
          You have Signed-In
      </p>
  </div>

<br/>
<br/>

  <div id="startButtons">
        <a class="btn btn-small btn-primary nav-tabs" id="signInButton" href="javascript:void(0)" title="Sign in">Sign In</a>
  </div>
		
		
                    </div>
                 </div>
               </div>
            </div>
            <div w3-include-html="partials/footer.html"> </div>
        </div>
    </div>
    
	<script>
	$(function () {
		onLoad();	
	});
	// Operations when the web page is loaded.
	function onLoad() {
		var i, items, tabs;
		items = document.getElementsByClassName("tab-pane");
		for (i = 0; i < items.length; i++) {
			items[i].style.display = 'none';
		}
		document.getElementById("statusNotAuth").style.display = 'block';
		document.getElementById("statusAuth").style.display = 'none';
		// Initiatlize CognitoAuth object
		var auth = initCognitoSDK();
		document.getElementById("signInButton").addEventListener("click", function() {
			userButton(auth);
		});
		var curUrl = window.location.href;
		auth.parseCognitoWebResponse(curUrl);
	}
  // Operation when tab is closed.
	function closeTab(tabName) {
	  document.getElementById(tabName).style.display = 'none';
	}
  // Operation when tab is opened.
  function openTab(tabName) {
		document.getElementById(tabName).style.display = 'block';
	}
  // Operations when showing message.
	function showMessage(msgTitle, msgText, msgDetail) {
		var msgTab = document.getElementById('message');
		document.getElementById('messageTitle').innerHTML = msgTitle;
		document.getElementById('messageText').innerHTML = msgText;
		document.getElementById('messageDetail').innerHTML = msgDetail;
		msgTab.style.display = "block";
	}
  // Perform user operations.
	function userButton(auth) {
		var state = document.getElementById('signInButton').innerHTML;
		if (state === "Sign Out") {
			document.getElementById("signInButton").innerHTML = "Sign In";
			auth.signOut();
			showSignedOut();
		} else {
			auth.getSession();
		}
	}
	// Operations when signed in.
  function showSignedIn(session) {
		document.getElementById("statusNotAuth").style.display = 'none';
		document.getElementById("statusAuth").style.display = 'block';
		document.getElementById("signInButton").innerHTML = "Sign Out";
	}
	// Operations when signed out.
	function showSignedOut() {
		document.getElementById("statusNotAuth").style.display = 'block';
		document.getElementById("statusAuth").style.display = 'none';
	}
  // Initialize a cognito auth object.
	function initCognitoSDK() {
		var authData = {
				ClientId : '33i51jtcqrisallfq09ddfoc1e', // Your client id here
				AppWebDomain : 'aishtek.auth.ap-south-1.amazoncognito.com',
				TokenScopesArray : ['email', 'openid', 'phone'], // e.g.['phone', 'email', 'profile','openid', 'aws.cognito.signin.user.admin'],
				RedirectUriSignIn : htmlURLBase + '/index.html',
				RedirectUriSignOut : htmlURLBase + '/login.html',
/*         				IdentityProvider : '<TODO: add identity provider you want to specify>', // e.g. 'Facebook', */
				UserPoolId : 'ap-south-1_jiWBJIz70', // Your user pool id here
				AdvancedSecurityDataCollectionFlag : 'false', // e.g. true
			    //Storage: 'LocalStorage' // OPTIONAL e.g. new CookieStorage(), to use the specified storage provided
			};
		var auth = new AmazonCognitoIdentity.CognitoAuth(authData);
		// You can also set state parameter 
		// auth.setState(<state parameter>);  
		auth.userhandler = {
			onSuccess: function(result) {
				alert("Sign in success");
				showSignedIn(result);
				window.location = htmlURLBase + '/index.html';
			},
			onFailure: function(err) {
				alert("Error!" + err);
			}
		};
		// The default response_type is "token", uncomment the next line will make it be "code".
		// auth.useCodeGrantFlow();
		return auth;
	}
	</script>
</body>
</html>